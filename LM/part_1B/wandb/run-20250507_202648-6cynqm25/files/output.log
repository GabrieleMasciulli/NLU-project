Starting training for run: lstm_l3_h1150_emb_dropout0.4_out_dropout0.4_SGD_then_NTAvSGD_VarDrop_GloVe
Epoch 17 | LR: 30.0000 | Train Loss: 4.3687 | Dev P
  Epoch 1: New best model found with SGD weights. Dev PPL: 1069.13.
  Saving model state (Epoch 1).
  Epoch 2: New best model found with SGD weights. Dev PPL: 384.12.
  Saving model state (Epoch 2).
  Epoch 3: New best model found with SGD weights. Dev PPL: 235.56.
  Saving model state (Epoch 3).
  Epoch 4: New best model found with SGD weights. Dev PPL: 196.63.
  Saving model state (Epoch 4).
  Epoch 5: New best model found with SGD weights. Dev PPL: 157.63.
  Saving model state (Epoch 5).
  Epoch 6: New best model found with SGD weights. Dev PPL: 145.47.
  Saving model state (Epoch 6).
  Epoch 7: New best model found with SGD weights. Dev PPL: 125.41.
  Saving model state (Epoch 7).
  Epoch 8: New best model found with SGD weights. Dev PPL: 119.01.
  Saving model state (Epoch 8).
  Epoch 9: New best model found with SGD weights. Dev PPL: 113.63.
  Saving model state (Epoch 9).
  Epoch 10: New best model found with SGD weights. Dev PPL: 106.60.
  Saving model state (Epoch 10).
  Epoch 11: New best model found with SGD weights. Dev PPL: 104.89.
  Saving model state (Epoch 11).
  Epoch 12: New best model found with SGD weights. Dev PPL: 103.74.
  Saving model state (Epoch 12).
  Epoch 13: New best model found with SGD weights. Dev PPL: 98.84.
  Saving model state (Epoch 13).
  Epoch 14: New best model found with SGD weights. Dev PPL: 95.94.
  Saving model state (Epoch 14).
  Epoch 15: New best model found with SGD weights. Dev PPL: 93.73.
  Saving model state (Epoch 15).
  No improvement in Dev PPL (94.34 vs best 93.73). Patience: 1/10
  Epoch 17: New best model found with SGD weights. Dev PPL: 91.75.
  Saving model state (Epoch 17).
  Epoch 18: New best model found with SGD weights. Dev PPL: 91.21.
  Saving model state (Epoch 18).
  Epoch 19: New best model found with SGD weights. Dev PPL: 89.08.
  Saving model state (Epoch 19).
  Epoch 20: New best model found with SGD weights. Dev PPL: 88.73.
  Saving model state (Epoch 20).
  No improvement in Dev PPL (88.89 vs best 88.73). Patience: 1/10
  Epoch 22: New best model found with SGD weights. Dev PPL: 88.06.
  Saving model state (Epoch 22).
  Epoch 23: New best model found with SGD weights. Dev PPL: 87.85.
  Saving model state (Epoch 23).
  Epoch 24: New best model found with SGD weights. Dev PPL: 86.69.
  Saving model state (Epoch 24).
  No improvement in Dev PPL (87.38 vs best 86.69). Patience: 1/10
  Epoch 26: New best model found with SGD weights. Dev PPL: 85.70.
  Saving model state (Epoch 26).
  No improvement in Dev PPL (86.70 vs best 85.70). Patience: 1/10
  Epoch 28: New best model found with SGD weights. Dev PPL: 85.34.
  Saving model state (Epoch 28).
  No improvement in Dev PPL (85.61 vs best 85.34). Patience: 1/10
  Epoch 30: New best model found with SGD weights. Dev PPL: 85.21.
  Saving model state (Epoch 30).
  No improvement in Dev PPL (85.37 vs best 85.21). Patience: 1/10
  Epoch 32: New best model found with SGD weights. Dev PPL: 84.38.
  Saving model state (Epoch 32).
  Epoch 33: New best model found with SGD weights. Dev PPL: 84.36.
  Saving model state (Epoch 33).
  Epoch 34: New best model found with SGD weights. Dev PPL: 83.99.
  Saving model state (Epoch 34).
  No improvement in Dev PPL (84.70 vs best 83.99). Patience: 1/10
  No improvement in Dev PPL (86.52 vs best 83.99). Patience: 2/10
  Epoch 37: New best model found with SGD weights. Dev PPL: 83.08.
  Saving model state (Epoch 37).
  No improvement in Dev PPL (84.18 vs best 83.08). Patience: 1/10
  No improvement in Dev PPL (83.59 vs best 83.08). Patience: 2/10
  No improvement in Dev PPL (83.96 vs best 83.08). Patience: 3/10
  No improvement in Dev PPL (84.02 vs best 83.08). Patience: 4/10
  No improvement in Dev PPL (84.11 vs best 83.08). Patience: 5/10
  Halving learning rate from 30.0000 to 15.0000 as nonmono patience (5/5) reached before ASGD switch.
Switching to NT-ASGD optimizer at epoch 42 after 5 epochs of no improvement on dev PPL.
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
  Optimizer switched to NTAvSGD with LR: 15.0000 and averaging started.
  Epoch 43: Swapping to averaged weights for dev evaluation.
  Epoch 43: Swapping back to original weights after dev evaluation.
  Epoch 43: New best model found with averaged weights. Dev PPL: 80.23.
  Saving model state (Epoch 43).
  Epoch 44: Swapping to averaged weights for dev evaluation.
  Epoch 44: Swapping back to original weights after dev evaluation.
  Epoch 44: New best model found with averaged weights. Dev PPL: 79.73.
  Saving model state (Epoch 44).
  Epoch 45: Swapping to averaged weights for dev evaluation.
  Epoch 45: Swapping back to original weights after dev evaluation.
  Epoch 45: New best model found with averaged weights. Dev PPL: 79.53.
  Saving model state (Epoch 45).
  Epoch 46: Swapping to averaged weights for dev evaluation.
  Epoch 46: Swapping back to original weights after dev evaluation.
  Epoch 46: New best model found with averaged weights. Dev PPL: 79.44.
  Saving model state (Epoch 46).
  Epoch 47: Swapping to averaged weights for dev evaluation.
  Epoch 47: Swapping back to original weights after dev evaluation.
  Epoch 47: New best model found with averaged weights. Dev PPL: 79.41.
  Saving model state (Epoch 47).
  Epoch 48: Swapping to averaged weights for dev evaluation.
  Epoch 48: Swapping back to original weights after dev evaluation.
  Epoch 48: New best model found with averaged weights. Dev PPL: 79.37.
  Saving model state (Epoch 48).
  Epoch 49: Swapping to averaged weights for dev evaluation.
  Epoch 49: Swapping back to original weights after dev evaluation.
  Epoch 49: New best model found with averaged weights. Dev PPL: 79.37.
  Saving model state (Epoch 49).
  Epoch 50: Swapping to averaged weights for dev evaluation.
  Epoch 50: Swapping back to original weights after dev evaluation.
  No improvement in Dev PPL (79.40 vs best 79.37). Patience: 1/10
  Epoch 51: Swapping to averaged weights for dev evaluation.
  Epoch 51: Swapping back to original weights after dev evaluation.
  No improvement in Dev PPL (79.42 vs best 79.37). Patience: 2/10
  Epoch 52: Swapping to averaged weights for dev evaluation.
  Epoch 52: Swapping back to original weights after dev evaluation.
  No improvement in Dev PPL (79.46 vs best 79.37). Patience: 3/10
  Epoch 53: Swapping to averaged weights for dev evaluation.
  Epoch 53: Swapping back to original weights after dev evaluation.
  No improvement in Dev PPL (79.49 vs best 79.37). Patience: 4/10
  Epoch 54: Swapping to averaged weights for dev evaluation.
  Epoch 54: Swapping back to original weights after dev evaluation.
  No improvement in Dev PPL (79.53 vs best 79.37). Patience: 5/10
  Epoch 55: Swapping to averaged weights for dev evaluation.
  Epoch 55: Swapping back to original weights after dev evaluation.
  No improvement in Dev PPL (79.58 vs best 79.37). Patience: 6/10
  Epoch 56: Swapping to averaged weights for dev evaluation.
  Epoch 56: Swapping back to original weights after dev evaluation.
  No improvement in Dev PPL (79.64 vs best 79.37). Patience: 7/10
  Epoch 57: Swapping to averaged weights for dev evaluation.
  Epoch 57: Swapping back to original weights after dev evaluation.
  No improvement in Dev PPL (79.70 vs best 79.37). Patience: 8/10
  Epoch 58: Swapping to averaged weights for dev evaluation.
  Epoch 58: Swapping back to original weights after dev evaluation.
  No improvement in Dev PPL (79.75 vs best 79.37). Patience: 9/10
  Epoch 59: Swapping to averaged weights for dev evaluation.
  Epoch 59: Swapping back to original weights after dev evaluation.
  No improvement in Dev PPL (79.81 vs best 79.37). Patience: 10/10
Early stopping triggered after 10 epochs without improvement.

Training finished.
Loading best model state (from epoch 49, Dev PPL: 79.37) for final evaluation...
Evaluating on test set...
Final Test Perplexity: 76.65
Best model saved to bin/best_model_lstm_l3_h1150_emb_dropout0.4_out_dropout0.4_SGD_then_NTAvSGD_VarDrop_GloVe.pt
