Starting training for run: lstm_l3_h1150_emb_dropout0.4_out_dropout0.4_SGD_then_NTAvSGD_VarDrop_GloVe
Epoch 17 | LR: 30.0000 | Train Loss: 4.4589 | Dev PPL: 95.02:  16%|█████████▎                                                | 16/100 [09:59<49:17, 35.21s/it]
  Epoch 1: New best model found with SGD weights. Dev PPL: 608.89.
  Saving model state (Epoch 1).
  Epoch 2: New best model found with SGD weights. Dev PPL: 314.03.
  Saving model state (Epoch 2).
  Epoch 3: New best model found with SGD weights. Dev PPL: 214.64.
  Saving model state (Epoch 3).
  Epoch 4: New best model found with SGD weights. Dev PPL: 178.69.
  Saving model state (Epoch 4).
  Epoch 5: New best model found with SGD weights. Dev PPL: 153.61.
  Saving model state (Epoch 5).
  Epoch 6: New best model found with SGD weights. Dev PPL: 136.66.
  Saving model state (Epoch 6).
  Epoch 7: New best model found with SGD weights. Dev PPL: 131.35.
  Saving model state (Epoch 7).
  Epoch 8: New best model found with SGD weights. Dev PPL: 119.38.
  Saving model state (Epoch 8).
  Epoch 9: New best model found with SGD weights. Dev PPL: 116.71.
  Saving model state (Epoch 9).
  Epoch 10: New best model found with SGD weights. Dev PPL: 110.39.
  Saving model state (Epoch 10).
  Epoch 11: New best model found with SGD weights. Dev PPL: 107.61.
  Saving model state (Epoch 11).
  Epoch 12: New best model found with SGD weights. Dev PPL: 103.30.
  Saving model state (Epoch 12).
  Epoch 13: New best model found with SGD weights. Dev PPL: 100.86.
  Saving model state (Epoch 13).
  Epoch 14: New best model found with SGD weights. Dev PPL: 98.99.
  Saving model state (Epoch 14).
  Epoch 15: New best model found with SGD weights. Dev PPL: 96.05.
  Saving model state (Epoch 15).
  No improvement in Dev PPL (96.05 vs best 96.05). Patience: 1/10
  Epoch 17: New best model found with SGD weights. Dev PPL: 95.02.
  Saving model state (Epoch 17).
  Epoch 18: New best model found with SGD weights. Dev PPL: 94.75.
  Saving model state (Epoch 18).
  Epoch 19: New best model found with SGD weights. Dev PPL: 91.97.
  Saving model state (Epoch 19).
  No improvement in Dev PPL (93.46 vs best 91.97). Patience: 1/10
  Epoch 21: New best model found with SGD weights. Dev PPL: 90.29.
  Saving model state (Epoch 21).
  Epoch 22: New best model found with SGD weights. Dev PPL: 89.08.
  Saving model state (Epoch 22).
  No improvement in Dev PPL (89.83 vs best 89.08). Patience: 1/10
  No improvement in Dev PPL (89.17 vs best 89.08). Patience: 2/10
  No improvement in Dev PPL (89.45 vs best 89.08). Patience: 3/10
  Epoch 26: New best model found with SGD weights. Dev PPL: 88.06.
  Saving model state (Epoch 26).
  Epoch 27: New best model found with SGD weights. Dev PPL: 86.72.
  Saving model state (Epoch 27).
  Epoch 28: New best model found with SGD weights. Dev PPL: 86.52.
  Saving model state (Epoch 28).
  Epoch 29: New best model found with SGD weights. Dev PPL: 86.47.
  Saving model state (Epoch 29).
  Epoch 30: New best model found with SGD weights. Dev PPL: 85.89.
  Saving model state (Epoch 30).
  No improvement in Dev PPL (87.20 vs best 85.89). Patience: 1/10
  No improvement in Dev PPL (85.94 vs best 85.89). Patience: 2/10
  Epoch 33: New best model found with SGD weights. Dev PPL: 85.63.
  Saving model state (Epoch 33).
  No improvement in Dev PPL (85.77 vs best 85.63). Patience: 1/10
  Epoch 35: New best model found with SGD weights. Dev PPL: 85.13.
  Saving model state (Epoch 35).
  Epoch 36: New best model found with SGD weights. Dev PPL: 84.93.
  Saving model state (Epoch 36).
  No improvement in Dev PPL (85.39 vs best 84.93). Patience: 1/10
  No improvement in Dev PPL (85.13 vs best 84.93). Patience: 2/10
  No improvement in Dev PPL (85.05 vs best 84.93). Patience: 3/10
  No improvement in Dev PPL (85.06 vs best 84.93). Patience: 4/10
  No improvement in Dev PPL (85.02 vs best 84.93). Patience: 5/10
  Halving learning rate from 30.0000 to 15.0000 as nonmono patience (5/5) reached before ASGD switch.
Switching to NT-ASGD optimizer at epoch 41 after 5 epochs of no improvement on dev PPL.
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
NTAvSGD: Starting averaging at step 0
  Optimizer switched to NTAvSGD with LR: 15.0000 and averaging started.
  Epoch 42: Swapping to averaged weights for dev evaluation.
  Epoch 42: Swapping back to original weights after dev evaluation.
  Epoch 42: New best model found with averaged weights. Dev PPL: 80.09.
  Saving model state (Epoch 42).
  Epoch 43: Swapping to averaged weights for dev evaluation.
  Epoch 43: Swapping back to original weights after dev evaluation.
  Epoch 43: New best model found with averaged weights. Dev PPL: 79.48.
  Saving model state (Epoch 43).
  Epoch 44: Swapping to averaged weights for dev evaluation.
  Epoch 44: Swapping back to original weights after dev evaluation.
  Epoch 44: New best model found with averaged weights. Dev PPL: 79.17.
  Saving model state (Epoch 44).
  Epoch 45: Swapping to averaged weights for dev evaluation.
  Epoch 45: Swapping back to original weights after dev evaluation.
  Epoch 45: New best model found with averaged weights. Dev PPL: 79.01.
  Saving model state (Epoch 45).
  Epoch 46: Swapping to averaged weights for dev evaluation.
  Epoch 46: Swapping back to original weights after dev evaluation.
  Epoch 46: New best model found with averaged weights. Dev PPL: 78.86.
  Saving model state (Epoch 46).
  Epoch 47: Swapping to averaged weights for dev evaluation.
  Epoch 47: Swapping back to original weights after dev evaluation.
  Epoch 47: New best model found with averaged weights. Dev PPL: 78.72.
  Saving model state (Epoch 47).
  Epoch 48: Swapping to averaged weights for dev evaluation.
  Epoch 48: Swapping back to original weights after dev evaluation.
  Epoch 48: New best model found with averaged weights. Dev PPL: 78.64.
  Saving model state (Epoch 48).
  Epoch 49: Swapping to averaged weights for dev evaluation.
  Epoch 49: Swapping back to original weights after dev evaluation.
  Epoch 49: New best model found with averaged weights. Dev PPL: 78.57.
  Saving model state (Epoch 49).
  Epoch 50: Swapping to averaged weights for dev evaluation.
  Epoch 50: Swapping back to original weights after dev evaluation.
  Epoch 50: New best model found with averaged weights. Dev PPL: 78.52.
  Saving model state (Epoch 50).
  Epoch 51: Swapping to averaged weights for dev evaluation.
  Epoch 51: Swapping back to original weights after dev evaluation.
  Epoch 51: New best model found with averaged weights. Dev PPL: 78.49.
  Saving model state (Epoch 51).
  Epoch 52: Swapping to averaged weights for dev evaluation.
  Epoch 52: Swapping back to original weights after dev evaluation.
  Epoch 52: New best model found with averaged weights. Dev PPL: 78.45.
  Saving model state (Epoch 52).
  Epoch 53: Swapping to averaged weights for dev evaluation.
  Epoch 53: Swapping back to original weights after dev evaluation.
  Epoch 53: New best model found with averaged weights. Dev PPL: 78.42.
  Saving model state (Epoch 53).
  Epoch 54: Swapping to averaged weights for dev evaluation.
  Epoch 54: Swapping back to original weights after dev evaluation.
  Epoch 54: New best model found with averaged weights. Dev PPL: 78.40.
  Saving model state (Epoch 54).

Training interrupted by user.

Training finished.
Loading best model state (from epoch 54, Dev PPL: 78.40) for final evaluation...
Evaluating on test set...
Final Test Perplexity: 75.59
Best model saved to bin/best_model_lstm_l3_h1150_emb_dropout0.4_out_dropout0.4_SGD_then_NTAvSGD_VarDrop_GloVe.pt
