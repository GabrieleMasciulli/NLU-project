--- Starting Training: joint-bert-atis-CTRAN_lr5e-05_bs32_do0.15 ---

--- Epoch 1/15 ---
Evaluating:   0%|                                                                                                                      | 0/8 [00:00<?, ?it/s]/home/disi/NLU-project/.venv/lib/python3.8/site-packages/torch/nn/modules/transformer.py:409: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. (Triggered internally at ../aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(output, src_key_padding_mask.logical_not(), mask_check=False)
                                                                                                                                                             
Epoch 1 Summary:
  Avg Train Loss: 1.6018
  Dev Intent Acc: 0.9639
  Dev Slot F1 (Macro): 0.0308
  Dev Combined Metric: 0.4973
  New best model found! Metric: 0.4973. Saving...

--- Epoch 2/15 ---
Epoch 2 Summary:
  Avg Train Loss: 0.6274
  Dev Intent Acc: 0.9859
  Dev Slot F1 (Macro): 0.0480
  Dev Combined Metric: 0.5170
  New best model found! Metric: 0.5170. Saving...

--- Epoch 3/15 ---
Epoch 3 Summary:
  Avg Train Loss: 0.4315
  Dev Intent Acc: 0.9880
  Dev Slot F1 (Macro): 0.0802
  Dev Combined Metric: 0.5341
  New best model found! Metric: 0.5341. Saving...

--- Epoch 4/15 ---
Epoch 4 Summary:
  Avg Train Loss: 0.3242
  Dev Intent Acc: 0.9920
  Dev Slot F1 (Macro): 0.0977
  Dev Combined Metric: 0.5448
  New best model found! Metric: 0.5448. Saving...

--- Epoch 5/15 ---
Epoch 5 Summary:
  Avg Train Loss: 0.2581
  Dev Intent Acc: 0.9940
  Dev Slot F1 (Macro): 0.1386
  Dev Combined Metric: 0.5663
  New best model found! Metric: 0.5663. Saving...

--- Epoch 6/15 ---
Epoch 6 Summary:
  Avg Train Loss: 0.2250
  Dev Intent Acc: 0.9940
  Dev Slot F1 (Macro): 0.1924
  Dev Combined Metric: 0.5932
  New best model found! Metric: 0.5932. Saving...

--- Epoch 7/15 ---
Epoch 7 Summary:
  Avg Train Loss: 0.1938
  Dev Intent Acc: 0.9920
  Dev Slot F1 (Macro): 0.2245
  Dev Combined Metric: 0.6082
  New best model found! Metric: 0.6082. Saving...

--- Epoch 8/15 ---
Epoch 8 Summary:
  Avg Train Loss: 0.1668
  Dev Intent Acc: 0.9940
  Dev Slot F1 (Macro): 0.3124
  Dev Combined Metric: 0.6532
  New best model found! Metric: 0.6532. Saving...

--- Epoch 9/15 ---
Epoch 9 Summary:
  Avg Train Loss: 0.1470
  Dev Intent Acc: 0.9940
  Dev Slot F1 (Macro): 0.3435
  Dev Combined Metric: 0.6687
  New best model found! Metric: 0.6687. Saving...

--- Epoch 10/15 ---
Epoch 10 Summary:
  Avg Train Loss: 0.1315
  Dev Intent Acc: 0.9960
  Dev Slot F1 (Macro): 0.3570
  Dev Combined Metric: 0.6765
  New best model found! Metric: 0.6765. Saving...

--- Epoch 11/15 ---
Epoch 11 Summary:
  Avg Train Loss: 0.1192
  Dev Intent Acc: 0.9940
  Dev Slot F1 (Macro): 0.4020
  Dev Combined Metric: 0.6980
  New best model found! Metric: 0.6980. Saving...

--- Epoch 12/15 ---
Epoch 12 Summary:
  Avg Train Loss: 0.1106
  Dev Intent Acc: 0.9960
  Dev Slot F1 (Macro): 0.4219
  Dev Combined Metric: 0.7090
  New best model found! Metric: 0.7090. Saving...

--- Epoch 13/15 ---
Epoch 13 Summary:
  Avg Train Loss: 0.1022
  Dev Intent Acc: 0.9940
  Dev Slot F1 (Macro): 0.4722
  Dev Combined Metric: 0.7331
  New best model found! Metric: 0.7331. Saving...

--- Epoch 14/15 ---
Epoch 14 Summary:
  Avg Train Loss: 0.0984
  Dev Intent Acc: 0.9940
  Dev Slot F1 (Macro): 0.4787
  Dev Combined Metric: 0.7364
  New best model found! Metric: 0.7364. Saving...

--- Epoch 15/15 ---
Epoch 15 Summary:
  Avg Train Loss: 0.0954
  Dev Intent Acc: 0.9960
  Dev Slot F1 (Macro): 0.5189
  Dev Combined Metric: 0.7574
  New best model found! Metric: 0.7574. Saving...

--- Evaluating best model on Test Set ---
Loading best model from epoch 15 (Dev Metric: 0.7574)

--- Test Results ---
Intent Accuracy: 0.9754
Slot F1 (Macro): 0.3643
Slot F1 (Micro): 0.9671

Slot Classification Report:
                              precision    recall  f1-score   support

           B-fare_basis_code     0.0000    0.0000    0.0000         2
              B-airline_name     0.9355    0.9667    0.9508        30
          B-depart_time.time     0.0000    0.0000    0.0000         1
              B-airline_code     0.2857    1.0000    0.4444         2
 B-depart_time.time_relative     0.0000    0.0000    0.0000         2
                    B-flight     0.0000    0.0000    0.0000         1
         I-fromloc.city_name     0.0000    0.0000    0.0000        19
                I-round_trip     1.0000    0.6000    0.7500         5
                B-flight_mod     0.7500    0.5000    0.6000         6
    B-depart_date.month_name     1.0000    0.5000    0.6667         4
                       B-mod     0.0000    0.0000    0.0000         1
    B-depart_date.day_number     1.0000    0.6667    0.8000         3
              I-airport_name     0.0000    0.0000    0.0000         1
             B-aircraft_code     0.0000    0.0000    0.0000         1
          I-depart_time.time     0.0000    0.0000    0.0000         1
             B-cost_relative     0.6667    0.4000    0.5000         5
                B-round_trip     0.6842    0.7647    0.7222        17
                   B-connect     0.0000    0.0000    0.0000         1
              I-airline_name     1.0000    1.0000    1.0000        11
                      B-meal     0.0000    0.0000    0.0000         5
 B-depart_date.date_relative     0.0000    0.0000    0.0000         2
 B-depart_time.period_of_day     0.6429    0.6429    0.6429        14
                           O     0.9938    0.9979    0.9959      2414
                 B-city_name     0.0000    0.0000    0.0000         3
          B-meal_description     0.0000    0.0000    0.0000         1
              B-airport_name     0.0000    0.0000    0.0000         1
B-depart_date.today_relative     0.0000    0.0000    0.0000         1
      B-depart_date.day_name     0.6061    0.8333    0.7018        24
                B-class_type     0.8000    0.8000    0.8000         5
           B-toloc.city_name     0.7692    0.8333    0.8000        24
              B-airport_code     0.3750    0.7500    0.5000         4
                B-state_name     0.0000    0.0000    0.0000         5
         B-fromloc.city_name     0.7164    1.0000    0.8348        48
                I-class_type     0.0000    0.0000    0.0000         2
               B-flight_stop     0.6250    1.0000    0.7692         5
          B-restriction_code     0.0000    0.0000    0.0000         2
            B-transport_type     1.0000    1.0000    1.0000         2

                    accuracy                         0.9671      2675
                   macro avg     0.3743    0.3853    0.3643      2675
                weighted avg     0.9560    0.9671    0.9602      2675


Test Set Performance:
  Intent Accuracy: 0.9754
  Slot F1 (Macro): 0.3643
  Slot F1 (Micro): 0.9671
Best model state saved to bin/best_model_joint-bert-atis-CTRAN_lr5e-05_bs32_do0.15.pt
