--- Starting Training: joint-bert-atis_lr5e-05_bs32_alpha0.3_do0.15 ---

--- Epoch 1/10 ---
                                                                                                                                                               
Epoch 1 Summary:
  Avg Train Loss: 0.7117
  Dev Intent Acc: 0.9137
  Dev Slot F1 (Macro): 0.0669
  Dev Combined Metric: 0.4903
  New best model found! Metric: 0.4903. Saving...

--- Epoch 2/10 ---
Epoch 2 Summary:
  Avg Train Loss: 0.2548
  Dev Intent Acc: 0.9618
  Dev Slot F1 (Macro): 0.4378
  Dev Combined Metric: 0.6998
  New best model found! Metric: 0.6998. Saving...

--- Epoch 3/10 ---
Epoch 3 Summary:
  Avg Train Loss: 0.1299
  Dev Intent Acc: 0.9679
  Dev Slot F1 (Macro): 0.5548
  Dev Combined Metric: 0.7613
  New best model found! Metric: 0.7613. Saving...

--- Epoch 4/10 ---
Epoch 4 Summary:
  Avg Train Loss: 0.0789
  Dev Intent Acc: 0.9759
  Dev Slot F1 (Macro): 0.6397
  Dev Combined Metric: 0.8078
  New best model found! Metric: 0.8078. Saving...

--- Epoch 5/10 ---
Epoch 5 Summary:
  Avg Train Loss: 0.0589
  Dev Intent Acc: 0.9839
  Dev Slot F1 (Macro): 0.6546
  Dev Combined Metric: 0.8193
  New best model found! Metric: 0.8193. Saving...

--- Epoch 6/10 ---
Epoch 6 Summary:
  Avg Train Loss: 0.0436
  Dev Intent Acc: 0.9900
  Dev Slot F1 (Macro): 0.6503
  Dev Combined Metric: 0.8201
  New best model found! Metric: 0.8201. Saving...

--- Epoch 7/10 ---
Epoch 7 Summary:
  Avg Train Loss: 0.0331
  Dev Intent Acc: 0.9900
  Dev Slot F1 (Macro): 0.6406
  Dev Combined Metric: 0.8153
  No improvement. Patience: 1/3

--- Epoch 8/10 ---
Epoch 8 Summary:
  Avg Train Loss: 0.0279
  Dev Intent Acc: 0.9900
  Dev Slot F1 (Macro): 0.6503
  Dev Combined Metric: 0.8201
  No improvement. Patience: 2/3

--- Epoch 9/10 ---
Epoch 9 Summary:
  Avg Train Loss: 0.0251
  Dev Intent Acc: 0.9880
  Dev Slot F1 (Macro): 0.6503
  Dev Combined Metric: 0.8191
  No improvement. Patience: 3/3
Early stopping triggered after 9 epochs.

--- Evaluating best model on Test Set ---
Loading best model from epoch 6 (Dev Metric: 0.8201)

--- Test Results ---
Intent Accuracy: 0.9642
Slot F1 (Macro): 0.4890
Slot F1 (Micro): 0.9761

Slot Classification Report:
                              precision    recall  f1-score   support

           B-fare_basis_code     0.0000    0.0000    0.0000         2
                I-class_type     1.0000    1.0000    1.0000         2
             B-aircraft_code     0.0000    0.0000    0.0000         1
          I-depart_time.time     0.0000    0.0000    0.0000         1
          B-depart_time.time     0.0000    0.0000    0.0000         1
                    B-flight     0.0000    0.0000    0.0000         1
          B-meal_description     0.0000    0.0000    0.0000         1
    B-depart_date.month_name     1.0000    0.7500    0.8571         4
              B-airport_code     1.0000    0.5000    0.6667         4
               B-flight_stop     0.8333    1.0000    0.9091         5
      B-depart_date.day_name     0.7059    1.0000    0.8276        24
             B-cost_relative     1.0000    1.0000    1.0000         5
         B-fromloc.city_name     1.0000    1.0000    1.0000        48
 B-depart_time.time_relative     0.0000    0.0000    0.0000         2
              I-airport_name     0.0000    0.0000    0.0000         1
    B-depart_date.day_number     1.0000    1.0000    1.0000         3
                           O     0.9938    0.9921    0.9930      2414
                B-round_trip     0.9375    0.8824    0.9091        17
                 B-city_name     0.0000    0.0000    0.0000         3
 B-depart_time.period_of_day     0.7500    0.6429    0.6923        14
         I-fromloc.city_name     1.0000    0.8947    0.9444        19
                      B-meal     0.0000    0.0000    0.0000         5
          B-restriction_code     1.0000    1.0000    1.0000         2
                B-class_type     1.0000    0.8000    0.8889         5
                   B-connect     0.0000    0.0000    0.0000         1
           B-toloc.city_name     0.5854    1.0000    0.7385        24
              I-airline_name     1.0000    1.0000    1.0000        11
              B-airline_name     1.0000    1.0000    1.0000        30
                       B-mod     0.0000    0.0000    0.0000         1
                B-flight_mod     1.0000    0.5000    0.6667         6
                I-round_trip     1.0000    1.0000    1.0000         5
 B-depart_date.date_relative     0.0000    0.0000    0.0000         2
                B-state_name     0.0000    0.0000    0.0000         5
              B-airline_code     0.2000    1.0000    0.3333         2
B-depart_date.today_relative     0.0000    0.0000    0.0000         1
              B-airport_name     0.0000    0.0000    0.0000         1
            B-transport_type     1.0000    0.5000    0.6667         2

                   micro avg     0.9764    0.9757    0.9761      2675
                   macro avg     0.5137    0.4990    0.4890      2675
                weighted avg     0.9746    0.9757    0.9737      2675


Test Set Performance:
  Intent Accuracy: 0.9642
  Slot F1 (Macro): 0.4890
  Slot F1 (Micro): 0.9761
Best model state saved to bin/best_model_u3wzrdam.pt
