--- Starting Training: joint-bert-atis-CTRAN-dropout-sweep_lr5e-05_bs32_do0.2 ---

--- Epoch 1/25 ---
Evaluating:   0%|                                                                        | 0/8 [00:00<?, ?it/s]/home/disi/NLU-project/.venv/lib/python3.8/site-packages/torch/nn/modules/transformer.py:409: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. (Triggered internally at ../aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(output, src_key_padding_mask.logical_not(), mask_check=False)
                                                                                                                                                           
Epoch 1 Summary:
  Avg Train Loss: 1.6752
  Dev Intent Acc: 0.9578
  Dev Slot F1 (Macro): 0.0308
  Dev Combined Metric: 0.4943
  New best model found! Metric: 0.4943. Saving...

--- Epoch 2/25 ---
Epoch 2 Summary:
  Avg Train Loss: 0.7447
  Dev Intent Acc: 0.9759
  Dev Slot F1 (Macro): 0.0308
  Dev Combined Metric: 0.5034
  New best model found! Metric: 0.5034. Saving...

--- Epoch 3/25 ---
Epoch 3 Summary:
  Avg Train Loss: 0.6228
  Dev Intent Acc: 0.9920
  Dev Slot F1 (Macro): 0.0308
  Dev Combined Metric: 0.5114
  New best model found! Metric: 0.5114. Saving...

--- Epoch 4/25 ---
Epoch 4 Summary:
  Avg Train Loss: 0.5744
  Dev Intent Acc: 0.9880
  Dev Slot F1 (Macro): 0.0308
  Dev Combined Metric: 0.5094
  No improvement. Patience: 1/3

--- Epoch 5/25 ---
Epoch 5 Summary:
  Avg Train Loss: 0.5584
  Dev Intent Acc: 0.9920
  Dev Slot F1 (Macro): 0.0308
  Dev Combined Metric: 0.5114
  No improvement. Patience: 2/3

--- Epoch 6/25 ---
Epoch 6 Summary:
  Avg Train Loss: 0.5437
  Dev Intent Acc: 0.9920
  Dev Slot F1 (Macro): 0.0308
  Dev Combined Metric: 0.5114
  No improvement. Patience: 3/3
Early stopping triggered after 6 epochs.

--- Evaluating best model on Test Set ---
Loading best model from epoch 3 (Dev Metric: 0.5114)

--- Test Results ---
Intent Accuracy: 0.9686
Slot F1 (Macro): 0.0256
Slot F1 (Micro): 0.9024

Slot Classification Report:
                              precision    recall  f1-score   support

B-depart_date.today_relative     0.0000    0.0000    0.0000         1
              I-airport_name     0.0000    0.0000    0.0000         1
    B-depart_date.day_number     0.0000    0.0000    0.0000         3
                B-class_type     0.0000    0.0000    0.0000         5
                   B-connect     0.0000    0.0000    0.0000         1
             B-aircraft_code     0.0000    0.0000    0.0000         1
                 B-city_name     0.0000    0.0000    0.0000         3
                       B-mod     0.0000    0.0000    0.0000         1
          B-depart_time.time     0.0000    0.0000    0.0000         1
                B-round_trip     0.0000    0.0000    0.0000        17
              B-airport_code     0.0000    0.0000    0.0000         4
                           O     0.9024    1.0000    0.9487      2414
              I-airline_name     0.0000    0.0000    0.0000        11
 B-depart_date.date_relative     0.0000    0.0000    0.0000         2
 B-depart_time.time_relative     0.0000    0.0000    0.0000         2
              B-airline_code     0.0000    0.0000    0.0000         2
    B-depart_date.month_name     0.0000    0.0000    0.0000         4
         B-fromloc.city_name     0.0000    0.0000    0.0000        48
                I-round_trip     0.0000    0.0000    0.0000         5
                      B-meal     0.0000    0.0000    0.0000         5
                    B-flight     0.0000    0.0000    0.0000         1
            B-transport_type     0.0000    0.0000    0.0000         2
      B-depart_date.day_name     0.0000    0.0000    0.0000        24
         I-fromloc.city_name     0.0000    0.0000    0.0000        19
              B-airline_name     0.0000    0.0000    0.0000        30
           B-toloc.city_name     0.0000    0.0000    0.0000        24
          B-meal_description     0.0000    0.0000    0.0000         1
                I-class_type     0.0000    0.0000    0.0000         2
               B-flight_stop     0.0000    0.0000    0.0000         5
 B-depart_time.period_of_day     0.0000    0.0000    0.0000        14
          B-restriction_code     0.0000    0.0000    0.0000         2
          I-depart_time.time     0.0000    0.0000    0.0000         1
           B-fare_basis_code     0.0000    0.0000    0.0000         2
              B-airport_name     0.0000    0.0000    0.0000         1
             B-cost_relative     0.0000    0.0000    0.0000         5
                B-state_name     0.0000    0.0000    0.0000         5
                B-flight_mod     0.0000    0.0000    0.0000         6

                    accuracy                         0.9024      2675
                   macro avg     0.0244    0.0270    0.0256      2675
                weighted avg     0.8144    0.9024    0.8561      2675


Test Set Performance:
  Intent Accuracy: 0.9686
  Slot F1 (Macro): 0.0256
  Slot F1 (Micro): 0.9024
Best model state saved to bin/best_model_joint-bert-atis-CTRAN-dropout-sweep_lr5e-05_bs32_do0.2.pt
