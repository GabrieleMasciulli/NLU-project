--- Starting Training: joint-bert-atis-CRF_lr5e-05_bs32_alpha0.5_do0.15 ---

--- Epoch 1/10 ---
                                                                                                                                                         
Epoch 1 Summary:
  Avg Train Loss: 2.6407
  Dev Intent Acc: 0.8032
  Dev Slot F1 (Macro): 0.0399
  Dev Combined Metric: 0.4215
  New best model found! Metric: 0.4215. Saving...

--- Epoch 2/10 ---
Epoch 2 Summary:
  Avg Train Loss: 0.9456
  Dev Intent Acc: 0.8675
  Dev Slot F1 (Macro): 0.0664
  Dev Combined Metric: 0.4669
  New best model found! Metric: 0.4669. Saving...

--- Epoch 3/10 ---
Epoch 3 Summary:
  Avg Train Loss: 0.6982
  Dev Intent Acc: 0.9257
  Dev Slot F1 (Macro): 0.1064
  Dev Combined Metric: 0.5160
  New best model found! Metric: 0.5160. Saving...

--- Epoch 4/10 ---
Epoch 4 Summary:
  Avg Train Loss: 0.5121
  Dev Intent Acc: 0.9337
  Dev Slot F1 (Macro): 0.2099
  Dev Combined Metric: 0.5718
  New best model found! Metric: 0.5718. Saving...

--- Epoch 5/10 ---
Epoch 5 Summary:
  Avg Train Loss: 0.3853
  Dev Intent Acc: 0.9518
  Dev Slot F1 (Macro): 0.3194
  Dev Combined Metric: 0.6356
  New best model found! Metric: 0.6356. Saving...

--- Epoch 6/10 ---
Epoch 6 Summary:
  Avg Train Loss: 0.3017
  Dev Intent Acc: 0.9578
  Dev Slot F1 (Macro): 0.4618
  Dev Combined Metric: 0.7098
  New best model found! Metric: 0.7098. Saving...

--- Epoch 7/10 ---
Epoch 7 Summary:
  Avg Train Loss: 0.2432
  Dev Intent Acc: 0.9639
  Dev Slot F1 (Macro): 0.5470
  Dev Combined Metric: 0.7554
  New best model found! Metric: 0.7554. Saving...

--- Epoch 8/10 ---
Epoch 8 Summary:
  Avg Train Loss: 0.2052
  Dev Intent Acc: 0.9679
  Dev Slot F1 (Macro): 0.5566
  Dev Combined Metric: 0.7622
  New best model found! Metric: 0.7622. Saving...

--- Epoch 9/10 ---
Epoch 9 Summary:
  Avg Train Loss: 0.1839
  Dev Intent Acc: 0.9639
  Dev Slot F1 (Macro): 0.5711
  Dev Combined Metric: 0.7675
  New best model found! Metric: 0.7675. Saving...

--- Epoch 10/10 ---
Epoch 10 Summary:
  Avg Train Loss: 0.1717
  Dev Intent Acc: 0.9639
  Dev Slot F1 (Macro): 0.5606
  Dev Combined Metric: 0.7623
  No improvement. Patience: 1/3

--- Evaluating best model on Test Set ---
Loading best model from epoch 9 (Dev Metric: 0.7675)

--- Test Results ---
Intent Accuracy: 0.8880
Slot F1 (Macro): 0.3462
Slot F1 (Micro): 0.9701

Slot Classification Report:
                              precision    recall  f1-score   support

             B-aircraft_code     0.0000    0.0000    0.0000         1
                           O     0.9905    0.9979    0.9942      2414
         B-fromloc.city_name     0.9600    1.0000    0.9796        48
             B-cost_relative     1.0000    0.6000    0.7500         5
                B-flight_mod     0.7500    0.5000    0.6000         6
              B-airport_code     0.4000    1.0000    0.5714         4
    B-depart_date.month_name     0.4000    0.5000    0.4444         4
 B-depart_date.date_relative     0.0000    0.0000    0.0000         2
                B-round_trip     0.8000    0.9412    0.8649        17
         I-fromloc.city_name     0.0000    0.0000    0.0000        19
            B-transport_type     0.0000    0.0000    0.0000         2
              B-airport_name     0.0000    0.0000    0.0000         1
          B-restriction_code     0.0000    0.0000    0.0000         2
           B-toloc.city_name     0.6000    1.0000    0.7500        24
                      B-meal     0.0000    0.0000    0.0000         5
                    B-flight     0.0000    0.0000    0.0000         1
                       B-mod     0.0000    0.0000    0.0000         1
                I-round_trip     1.0000    0.6000    0.7500         5
      B-depart_date.day_name     0.7586    0.9167    0.8302        24
                B-state_name     0.0000    0.0000    0.0000         5
                 B-city_name     0.0000    0.0000    0.0000         3
                   B-connect     0.0000    0.0000    0.0000         1
          B-depart_time.time     0.0000    0.0000    0.0000         1
                B-class_type     0.6667    0.8000    0.7273         5
                I-class_type     0.0000    0.0000    0.0000         2
          B-meal_description     0.0000    0.0000    0.0000         1
           B-fare_basis_code     0.0000    0.0000    0.0000         2
          I-depart_time.time     0.0000    0.0000    0.0000         1
B-depart_date.today_relative     0.0000    0.0000    0.0000         1
 B-depart_time.time_relative     0.0000    0.0000    0.0000         2
 B-depart_time.period_of_day     0.8750    0.5000    0.6364        14
              B-airline_code     0.2500    0.5000    0.3333         2
    B-depart_date.day_number     0.6000    1.0000    0.7500         3
               B-flight_stop     0.8333    1.0000    0.9091         5
              I-airport_name     0.0000    0.0000    0.0000         1
              B-airline_name     0.9375    1.0000    0.9677        30
              I-airline_name     1.0000    0.9091    0.9524        11

                   micro avg     0.9704    0.9697    0.9701      2675
                   macro avg     0.3465    0.3720    0.3462      2675
                weighted avg     0.9579    0.9697    0.9624      2675


Test Set Performance:
  Intent Accuracy: 0.8880
  Slot F1 (Macro): 0.3462
  Slot F1 (Micro): 0.9701
Best model state saved to bin/best_model_pihjh6c3.pt
