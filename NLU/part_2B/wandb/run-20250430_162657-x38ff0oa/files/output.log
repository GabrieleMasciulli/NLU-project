--- Starting Training: joint-bert-atis_lr5e-05_bs16_alpha0.5_do0.1 ---

--- Epoch 1/10 ---
                                                                                                                                                                 
Epoch 1 Summary:
  Avg Train Loss: 0.5760
  Dev Intent Acc: 0.9538
  Dev Slot F1 (Macro): 0.1292
  Dev Combined Metric: 0.5415
  New best model found! Metric: 0.5415. Saving...

--- Epoch 2/10 ---
Epoch 2 Summary:
  Avg Train Loss: 0.1908
  Dev Intent Acc: 0.9779
  Dev Slot F1 (Macro): 0.4759
  Dev Combined Metric: 0.7269
  New best model found! Metric: 0.7269. Saving...

--- Epoch 3/10 ---
Epoch 3 Summary:
  Avg Train Loss: 0.0981
  Dev Intent Acc: 0.9839
  Dev Slot F1 (Macro): 0.5677
  Dev Combined Metric: 0.7758
  New best model found! Metric: 0.7758. Saving...

--- Epoch 4/10 ---
Epoch 4 Summary:
  Avg Train Loss: 0.0627
  Dev Intent Acc: 0.9900
  Dev Slot F1 (Macro): 0.5915
  Dev Combined Metric: 0.7907
  New best model found! Metric: 0.7907. Saving...

--- Epoch 5/10 ---
Epoch 5 Summary:
  Avg Train Loss: 0.0413
  Dev Intent Acc: 0.9920
  Dev Slot F1 (Macro): 0.6080
  Dev Combined Metric: 0.8000
  New best model found! Metric: 0.8000. Saving...

--- Epoch 6/10 ---
Epoch 6 Summary:
  Avg Train Loss: 0.0285
  Dev Intent Acc: 0.9900
  Dev Slot F1 (Macro): 0.6428
  Dev Combined Metric: 0.8164
  New best model found! Metric: 0.8164. Saving...

--- Epoch 7/10 ---
Epoch 7 Summary:
  Avg Train Loss: 0.0217
  Dev Intent Acc: 0.9900
  Dev Slot F1 (Macro): 0.6446
  Dev Combined Metric: 0.8173
  New best model found! Metric: 0.8173. Saving...

--- Epoch 8/10 ---
Epoch 8 Summary:
  Avg Train Loss: 0.0176
  Dev Intent Acc: 0.9940
  Dev Slot F1 (Macro): 0.6403
  Dev Combined Metric: 0.8171
  No improvement. Patience: 1/3

--- Epoch 9/10 ---
Epoch 9 Summary:
  Avg Train Loss: 0.0146
  Dev Intent Acc: 0.9940
  Dev Slot F1 (Macro): 0.6422
  Dev Combined Metric: 0.8181
  New best model found! Metric: 0.8181. Saving...

--- Epoch 10/10 ---
Epoch 10 Summary:
  Avg Train Loss: 0.0128
  Dev Intent Acc: 0.9940
  Dev Slot F1 (Macro): 0.6403
  Dev Combined Metric: 0.8171
  No improvement. Patience: 1/3

--- Evaluating best model on Test Set ---
Loading best model from epoch 9 (Dev Metric: 0.8181)

--- Test Results ---
Intent Accuracy: 0.9765
Slot F1 (Macro): 0.5448
Slot F1 (Micro): 0.9776

Slot Classification Report:
                              precision    recall  f1-score   support

           B-fare_basis_code     0.0000    0.0000    0.0000         2
                      B-meal     0.0000    0.0000    0.0000         5
           B-toloc.city_name     0.7059    1.0000    0.8276        24
              B-airline_name     1.0000    1.0000    1.0000        30
          I-depart_time.time     0.0000    0.0000    0.0000         1
                   B-connect     0.0000    0.0000    0.0000         1
B-depart_date.today_relative     0.0000    0.0000    0.0000         1
              I-airline_name     1.0000    1.0000    1.0000        11
            B-transport_type     1.0000    1.0000    1.0000         2
                B-class_type     1.0000    0.8000    0.8889         5
    B-depart_date.day_number     0.6000    1.0000    0.7500         3
 B-depart_time.time_relative     1.0000    0.5000    0.6667         2
              I-airport_name     0.0000    0.0000    0.0000         1
                       B-mod     0.0000    0.0000    0.0000         1
              B-airport_code     1.0000    1.0000    1.0000         4
                 B-city_name     0.0000    0.0000    0.0000         3
                I-class_type     1.0000    1.0000    1.0000         2
                    B-flight     0.0000    0.0000    0.0000         1
              B-airport_name     0.0000    0.0000    0.0000         1
          B-depart_time.time     1.0000    1.0000    1.0000         1
                B-round_trip     0.8889    0.9412    0.9143        17
                B-state_name     0.0000    0.0000    0.0000         5
                           O     0.9905    0.9938    0.9921      2414
 B-depart_time.period_of_day     0.8000    0.5714    0.6667        14
             B-cost_relative     1.0000    1.0000    1.0000         5
    B-depart_date.month_name     1.0000    0.7500    0.8571         4
                I-round_trip     1.0000    0.8000    0.8889         5
              B-airline_code     0.1429    0.5000    0.2222         2
          B-meal_description     0.0000    0.0000    0.0000         1
               B-flight_stop     0.8333    1.0000    0.9091         5
      B-depart_date.day_name     0.8571    1.0000    0.9231        24
             B-aircraft_code     0.0000    0.0000    0.0000         1
                B-flight_mod     1.0000    0.6667    0.8000         6
         B-fromloc.city_name     0.9592    0.9792    0.9691        48
 B-depart_date.date_relative     0.0000    0.0000    0.0000         2
          B-restriction_code     1.0000    1.0000    1.0000         2
         I-fromloc.city_name     1.0000    0.7895    0.8824        19

                    accuracy                         0.9776      2675
                   macro avg     0.5616    0.5484    0.5448      2675
                weighted avg     0.9739    0.9776    0.9749      2675


Test Set Performance:
  Intent Accuracy: 0.9765
  Slot F1 (Macro): 0.5448
  Slot F1 (Micro): 0.9776
Best model state saved to bin/best_model_x38ff0oa.pt
